# By default, FortiOS is configured to look for 2 consecutive failed SSL VPN login attemtps from the same source IP address, and then block subsequent attempts for 60 seconds. But those are just the default thresholds. You can change them, and thank goodness. I’ve never felt those default values are any good. For starters, banning after 2 failed attempts is too likely to cause false positives (users often fat-finger their password twice in a row). But more importantly, 60 seconds isn’t long enough to seriously hinder true brute-force attacks. There are 86,400 seconds in a day, and if we’re only banning for 60 seconds at a time, and let’s say it takes the attacker 2 seconds to try their two failed login attempts (they’re using automated tooling), that’s 2 attempts every 62 seconds. So then that means they can try 2,787 passwords per day, or 83,613 passwords per month. Those odds are not great, given dictionary attacks and password re-use. And that’s just per-unique source IP address. Let’s say the attacker has a small botnet of 1,000 bots all with unique public IP addresses. Now the attacker can increase his password-guess rate by 1000x. Of course, ideally your IAM source should also be locking out the user account itself after a certain number of failed login attempts as well, but I’m just looking at the firewall side of things right now. And on the firewall side of things, if the attacker suspects the user account has been locked out (perhaps they have a list of user accounts they are working off of, from a public data breach), they’ll often not just be brute-forcing a single user account, but instead password spaying lots of different accounts. So blocking the offending source IPs is also important.

# Therefore, I recommend changing these settings to ban after a much higher threshold of failed login attempts, and for a much longer duration. I usually like to say “after 10 failed login attempts, block for 7 days.” My reasoning for this is: it’s almost impossible that the user fat-fingers their password 10 times in a row, so false positives are not very likely. If on the off-chance it was a false positive, they can still open a ticket with support to get unbanned. So then if 11 failed logins in a row gives a high confidence that it’s a true brute-force attack, than we should ban that IP for a long time, at least 7 days (if not longer), to cause extreme hinderance to the attacker. 10 attempts every 7 days means they can only try about 43 passwords per month, which is WAY better than the 83,613 passwords per month if we just leave the default values in place. It’s so much better that the attacker is likely to just cross you off their list of targets on move on to someone else.

# Of course, you should definitely still configure your SIEM to look for and alert on these kinds of brute-force attackers, no matter what thresholds you chose. But changing the thresholds themselves can provide tremendous levels of risk mitigation, making the chance of a successful brute-force attack WAY less likely.

# These thresholds are CLI only settings. The commands are below.

config vpn ssl settings
    set login-attempt-limit 10
    set login-block-time 604800
end
